// controllers/thaiFromAs400.js


// Thai mapping table จาก C# ที่คุณให้มา
const AS400_THAI_MAP = {
    // พยัญชนะไทย
    226: 'ก',  // case 226: 3585
    228: 'ข',  // case 228: 3586
    224: 'ฃ',  // case 224: 3587
    225: 'ค',  // case 225: 3588
    227: 'ฅ',  // case 227: 3589
    229: 'ฆ',  // case 229: 3590
    231: 'ง',  // case 231: 3591
    234: 'จ',  // case 234: 3592
    235: 'ฉ',  // case 235: 3593
    232: 'ช',  // case 232: 3594
    237: 'ซ',  // case 237: 3595
    238: 'ฌ',  // case 238: 3596
    239: 'ญ',  // case 239: 3597
    236: 'ฎ',  // case 236: 3598
    194: 'ฏ',  // case 194: 3599
    196: 'ฐ',  // case 196: 3600
    192: 'ฑ',  // case 192: 3601
    193: 'ฒ',  // case 193: 3602
    195: 'ณ',  // case 195: 3603
    197: 'ด',  // case 197: 3604
    199: 'ต',  // case 199: 3605
    202: 'ถ',  // case 202: 3606
    203: 'ท',  // case 203: 3607
    200: 'ธ',  // case 200: 3608
    205: 'น',  // case 205: 3609
    206: 'บ',  // case 206: 3610
    207: 'ป',  // case 207: 3611
    204: 'ผ',  // case 204: 3612
    171: 'ฝ',  // case 171: 3613
    187: 'พ',  // case 187: 3614
    240: 'ฟ',  // case 240: 3615
    253: 'ภ',  // case 253: 3616
    254: 'ม',  // case 254: 3617
    177: 'ย',  // case 177: 3618
    170: 'ร',  // case 170: 3619
    186: 'ฤ',  // case 186: 3620
    230: 'ล',  // case 230: 3621
    184: 'ฦ',  // case 184: 3622
    198: 'ว',  // case 198: 3623
    164: 'ศ',  // case 164: 3624
    161: 'ษ',  // case 161: 3625
    191: 'ส',  // case 191: 3626
    208: 'ห',  // case 208: 3627
    221: 'ฬ',  // case 221: 3628
    222: 'อ',  // case 222: 3629
    174: 'ฮ',  // case 174: 3630
    
    // สระและเครื่องหมาย
    91: 'ฯ',   // case 91: 3631
    93: 'ะ',   // case 93: 3632
    175: 'ั',  // case 175: 3633
    168: 'า',  // case 168: 3634
    180: 'ำ',  // case 180: 3635
    215: 'ิ',  // case 215: 3636
    244: 'ี',  // case 244: 3637
    246: 'ึ',  // case 246: 3638
    242: 'ื',  // case 242: 3639
    243: 'ุ',  // case 243: 3640
    245: 'ู',  // case 245: 3641
    185: 'ฺ',  // case 185: 3642
    
    // สระแม่กด และอื่นๆ
    248: '฿',  // case 248: 3647
    251: 'เ',  // case 251: 3648
    252: 'แ',  // case 252: 3649
    249: 'โ',  // case 249: 3650
    250: 'ใ',  // case 250: 3651
    255: 'ไ',  // case 255: 3652
    178: 'ๅ',  // case 178: 3653
    212: 'ๆ',  // case 212: 3654
    
    // วรรณยุกต์
    214: '็',  // case 214: 3655
    210: '่',  // case 210: 3656
    211: '้',  // case 211: 3657
    213: '๊',  // case 213: 3658
    179: '๋',  // case 179: 3659
    219: '์',  // case 219: 3660
    220: 'ํ',  // case 220: 3661
    201: '๎',  // case 201: 3662
    
    // ตัวเลขไทย
    216: '๏',  // case 216: 3663
    94: '๐',   // case 94: 3664
    163: '๑',  // case 163: 3665
    165: '๒',  // case 165: 3666
    183: '๓',  // case 183: 3667
    169: '๔',  // case 169: 3668
    167: '๕',  // case 167: 3669
    182: '๖',  // case 182: 3670
    188: '๗',  // case 188: 3671
    189: '๘',  // case 189: 3672
    190: '๙',  // case 190: 3673
    176: '๚',  // case 176: 3674
    181: '๛'   // case 181: 3675
};

// ฟังก์ชันแปลงภาษาไทยด้วย mapping table จาก C#
function convertthaiFromAs400(text) {
    if (!text || typeof text !== 'string' || text.trim() === '') {
        return text;
    }
    
    console.log(`Converting AS400 Thai: "${text}" (length: ${text.length})`);
    
    let result = '';
    for (let i = 0; i < text.length; i++) {
        const charCode = text.charCodeAt(i);
        
        // ใช้ mapping table จาก C#
        if (AS400_THAI_MAP[charCode]) {
            result += AS400_THAI_MAP[charCode];
            console.log(`Mapped ${charCode} -> ${AS400_THAI_MAP[charCode]}`);
        } else {
            // ถ้าไม่อยู่ใน mapping ให้เก็บตัวอักษรเดิม
            result += String.fromCharCode(charCode);
        }
    }
    
    console.log(`Conversion result: "${result}"`);
    return result;
}

module.exports = convertthaiFromAs400;
